# CVE-2022-0847
Hacked up Dirty Pipe (CVE-2022-0847) PoC that hijacks a SUID binary to spawn a root shell. (and attempts to restore the damaged binary as well)
<div class="container-fluid" id="Vuln3CvssPanel" data-testid="vuln-cvss3-panel" style="">
										
										<strong>CVSS 3.x Severity and Metrics:</strong>
										<div class="row no-gutters">
											<br>

											<div class="col-lg-3 col-sm-6">
												<div class="row">
													<div class="col-lg-3 col-sm-6">
														<img src="/site-media/images/NVD_NVD_Stack_Plain.svg" class="cvssNvdIcon" alt="NIST CVSS score">


													</div>
													<div class="col-lg-9 col-sm-6">
														<strong>NIST:</strong>&nbsp;<span class="wrapData" data-testid="vuln-cvss3-source-nvd">NVD</span>
													</div>
												</div>
											</div>
											<div class="col-lg-3 col-sm-6">
												<span><strong>Base
														Score:</strong>&nbsp;<span class="severityDetail"> <a id="Cvss3NistCalculatorAnchor" href="/vuln-metrics/cvss/v3-calculator?name=CVE-2022-0847&amp;vector=AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H&amp;version=3.1&amp;source=NIST" data-testid="vuln-cvss3-panel-score" class="label label-danger">7.8 HIGH</a>
												</span></span> 

											</div>
											<div class="col-lg-6 col-sm-12">
												<span><strong>Vector:</strong>&nbsp;
													<span data-testid="vuln-cvss3-nist-vector" class="tooltipCvss3NistMetrics" data-original-title="" title="">CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H</span></span>
												 <input type="hidden" id="nistV3MetricHidden" value="<span id = 'nistV3Metric' style = 'display:none' > <strong style ='font-size:1.2em' > CVSS v3.1 Severity and Metrics:</strong> <p data-testid='vuln-cvssv3-score-container'> <strong>Base Score: </strong> <span data-testid='vuln-cvssv3-base-score'>7.8 </span><span data-testid='vuln-cvssv3-base-score-severity'>HIGH</span> <br /> <strong>Vector: </strong> <span data-testid='vuln-cvssv3-vector'> AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H </span> <br /> <strong>Impact Score: </strong> <span data-testid='vuln-cvssv3-impact-score'> 5.9 </span> <br /> <strong>Exploitability Score: </strong> <span data-testid='vuln-cvssv3-exploitability-score'> 1.8 </span> </p> <hr /> <p data-testid='vuln-cvssv3-metrics-container'> <strong>Attack Vector (AV): </strong> <span data-testid='vuln-cvssv3-av'> Local </span> <br /> <strong>Attack Complexity (AC): </strong> <span data-testid='vuln-cvssv3-ac'> Low </span> <br /> <strong>Privileges Required (PR): </strong> <span data-testid='vuln-cvssv3-pr'> Low </span> <br /> <strong>User Interaction (UI): </strong> <span data-testid='vuln-cvssv3-ui'> None </span> <br /> <strong>Scope (S): </strong> <span data-testid='vuln-cvssv3-s'> Unchanged </span> <br /> <strong>Confidentiality (C): </strong> <span data-testid='vuln-cvssv3-c'> High </span> <br /> <strong>Integrity (I): </strong> <span data-testid='vuln-cvssv3-i'> High </span> <br /> <strong>Availability (A): </strong> <span data-testid='vuln-cvssv3-a'> High </span> </p> </span> ">

											</div>


										</div>

										
									
										<div id="cvss3FootNote" class="cvssFootNote">
										<br><br>
										 <span id="cvss3FootNoteSection"><i>NVD Analysts use publicly available information to associate vector strings and CVSS scores. We also display any CVSS information provided within the CVE List from the CNA.</i><br><br><i>Note: NVD Analysts have published a CVSS score for this CVE based on publicly available information at the time of analysis. The CNA has not provided a score within the CVE List.</i><br><br></span>
										</div>
									</div>
**Author: Max Kellermann** max.kellermann@ionos.com

A new Linux vulnerability known as 'Dirty Pipe' allows local users to gain root privileges through publicly available exploits.

Today, security researcher Max Kellermann responsibly disclosed the 'Dirty Pipe' vulnerability and stated that it affects Linux Kernel 5.8 and later versions, even on Android devices.

The vulnerability is tracked as CVE-2022-0847 and allows a non-privileged user to inject and overwrite data in read-only files, including SUID processes that run as root.

Kellerman discovered the bug after tracking down a bug that was corrupting web server access logs for one of his customers. 

## POC

````
gcc dirtypipez.c -o exploit
````

````
./exploit /bin/su
````
